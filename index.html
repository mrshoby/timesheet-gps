Modifica si index.html:

<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SERVELECT • Pontaj & Concedii</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="icon" href="favicon.png" />
  <meta name="theme-color" content="#516A75"/>
  <style>
    :root{
      --brand: rgba(81,106,117,0.88);
      --brand-dark:#2f3e45;
      --accent: rgba(149,202,75,0.91);
      --text:#0f172a;
      --muted:#5b6b73;
      --bg:#f4f7f9;
      --card:#ffffff;
      --ring:#cfe0e7;
      --danger:#ef4444;
      --warn:#f59e0b;
      --extra:#3b82f6; /* albastru pt. extra */
    }
    *{box-sizing:border-box}
    html,body{height:100%; width:100%}
    body{
      margin:0;
      font-family: Montserrat, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        linear-gradient(180deg, rgba(149, 202, 75, 0.91) 0%, rgba(81, 106, 117, 0.88) 66%),
        url('background.jpg');
      background-size: cover;
      background-position: center center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      min-height:100vh;
    }
    .shell{max-width:1100px;margin:0 auto;padding:24px;}
    .nav{
      display:flex;align-items:center;justify-content:space-between;
      gap:16px;padding:14px 16px;border-radius:16px;
      background:linear-gradient(180deg, rgba(255,255,255,.95), rgba(255,255,255,.80));
      backdrop-filter: blur(8px);
      box-shadow: 0 8px 30px rgba(81,106,117,.18);
      border:1px solid rgba(81,106,117,.18);
    }
    .brand{display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit}
    .brand img{ width:38px;height:38px;object-fit:contain;aspect-ratio:1/1;border-radius:10px;box-shadow:0 3px 10px rgba(81,106,117,.25) }
    .brand h1{font-size:18px;letter-spacing:.2px;margin:0;line-height:1.1}
    .brand h1 span{display:block;font-weight:700}
    .brand small{display:block;font-size:12px;color:var(--muted);margin-top:2px}
    .hero{ margin-top:20px; display:grid;grid-template-columns:1.1fr .9fr;gap:24px;align-items:stretch; }
    @media (max-width:900px){ .hero{grid-template-columns:1fr} }
    .card{ background:var(--card); border:1px solid rgba(14,165,233,.12); border-radius:18px; box-shadow:0 20px 60px rgba(2,132,199,.08); }
    .panel{padding:20px 20px 14px 20px}
    .panel header{ display:flex;align-items:center;gap:10px;margin:6px 0 14px; }
    .panel header .dot{ width:10px;height:10px;border-radius:50%;background:var(--accent); box-shadow:0 0 0 4px rgba(149,202,75,0.18); }
    .panel header h2{margin:0;font-size:18px}
    .sub{color:var(--muted);font-size:14px;margin:0 0 14px}
    label{display:block;font-size:12px;color:var(--muted);margin:4px 0 6px}
    .grid{display:grid;gap:14px}
    .grid.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    .grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    @media (max-width:900px){ .grid.cols-3,.grid.cols-2{grid-template-columns:1fr} }
    select, input[type="text"], input[type="email"], input[type="date"]{
      width:100%;padding:12px 12px;border-radius:12px;border:1px solid #e5e7eb;background:#fff;
      font-size:15px;outline:none;transition: box-shadow .15s, border-color .15s;
    }
    select:focus, input:focus{ border-color: var(--brand); box-shadow:0 0 0 4px var(--ring); }
    .btnbar{display:flex;flex-wrap:wrap;gap:10px;margin-top:8px}
    .btn{ --bg:#e2e8f0; --fg:#0f172a; appearance:none;border:0;border-radius:12px;padding:12px 16px;font-weight:600;
      cursor:pointer;transition: transform .06s ease, box-shadow .2s ease, background .2s; box-shadow:0 6px 16px rgba(15,23,42,.08);
      color:var(--fg);background:var(--bg); }
    .btn:active{transform: translateY(1px)}
    .btn.primary{ --bg: var(--accent); --fg:#fff }
    .btn.pause{ --bg:#f59e0b; --fg:#111827 }
    .btn.unpause{ --bg: var(--brand); --fg:#fff }
    .btn.finish{ --bg: var(--accent); --fg:#fff }
    .btn.extra{ --bg: var(--extra); --fg:#fff } /* buton Extra */
    .btn:disabled{opacity:.6;cursor:not-allowed;}
    .leave{ border:1px dashed #cbd5e1;border-radius:14px;padding:12px;background:#f8fafc; }
    .kicker{font-size:12px;color:var(--muted);margin-bottom:6px}
    .status{font-size:13px;color:var(--muted);margin-top:10px}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;white-space:pre-wrap}
    .chip{ display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:999px;background:rgba(81,106,117,.10);color:#2f3e45;font-weight:600;font-size:12px }
    .rail{padding:18px}
    .summary{ display:grid;gap:12px }
    .summary .item{ display:flex;align-items:center;gap:10px;padding:12px;border-radius:14px;background:#f8fafc;border:1px solid #e2e8f0; }
    .footer{ margin-top:18px;font-size:12px;color:var(--muted);text-align:center }
    .ok{color:#15803d} .err{color:#ef4444} .warn{color:#a16207}
  </style>
</head>
<body>
  <div class="shell">
    <nav class="nav card">
      <a class="brand" href="#" aria-label="Spre început">
        <img src="favicon.png" alt="Siglă SERVELECT" />
        <div>
          <h1><span>SERVELECT</span><small>Pontaj & Management Concedii</small></h1>
        </div>
      </a>
      <div class="chip" id="cfg">Se încarcă configurația…</div>
    </nav>

    <section class="hero">
      <div class="card panel">
        <header>
          <span class="dot" aria-hidden="true"></span>
          <h2>Înregistrare activitate</h2>
        </header>
        <p class="sub">Alege <b>Angajat</b>, <b>Tip de activitate</b>, completează <b>Locația</b> și (opțional) o <b>Notă</b>. Apoi folosește butoanele de mai jos.</p>

        <div class="grid cols-3">
          <div>
            <label for="employeeSelect">Angajat</label>
            <select id="employeeSelect"><option>Se încarcă...</option></select>
            <div class="status" id="empStatus"></div>
          </div>

          <div>
            <label for="activitySelect">Tip de activitate</label>
            <select id="activitySelect">
              <option value="" selected disabled>Alege tip...</option>
              <option>atelier</option>
              <option>birou-lucrare</option>
              <option>deplasare</option>
              <option>ofertare</option>
              <option>concediu de odihna</option>
              <option>concediu medical</option>
              <option>zi libera legala</option>
              <option>birou-administrativ</option>
              <option>home office</option>
              <option>invoire</option>
              <option>pe drum</option>
              <option>concediu pentru ore suplimentare</option>
              <option>birou + deplasare</option>
            </select>
          </div>

          <div>
            <label for="locationInput">Locație</label>
            <input id="locationInput" type="text" placeholder="ex: Șantier B – Poartă 2" />
          </div>
        </div>

        <div class="grid" style="margin-top:12px">
          <div>
            <label for="notes">Notă (opțional)</label>
            <input id="notes" type="text" placeholder="ex: Proiect X, client Y" />
          </div>
        </div>

        <!-- Leave panel -->
        <div id="leavePanel" class="leave" style="display:none;margin-top:16px">
          <div class="kicker"><b>Cerere concediu</b> — completează intervalul de zile, emailul personal și o notă. Se trimite automat la HR.</div>
          <div class="grid cols-3">
            <div>
              <label for="leaveStart">Data start</label>
              <input type="date" id="leaveStart" />
            </div>
            <div>
              <label for="leaveEnd">Data sfârșit</label>
              <input type="date" id="leaveEnd" />
            </div>
            <div>
              <label for="leaveEmail">Email personal</label>
              <input type="email" id="leaveEmail" placeholder="ex: prenume.nume@..." />
            </div>
          </div>
          <div class="grid" style="margin-top:10px">
            <div>
              <label for="leaveNotes">Notă către HR (opțional)</label>
              <input type="text" id="leaveNotes" placeholder="ex: motiv / detalii" />
            </div>
          </div>
          <div class="btnbar">
            <button id="btnLeave" class="btn primary" type="button">Trimite cererea de concediu</button>
            <span class="status" id="leaveStatus"></span>
          </div>
        </div>

        <div class="btnbar" style="margin-top:16px">
          <button class="btn primary" id="btnStart">Start</button>
          <button class="btn pause"   id="btnPause">Pause</button>
          <button class="btn unpause" id="btnUnpause">Unpause</button>
          <button class="btn finish"  id="btnFinish">Finish</button>
          <button class="btn extra"   id="btnExtra" title="Ore extra (separate de suplimentare)">Extra</button>
        </div>

        <div id="status" class="status" role="status" aria-live="polite"></div>
        <div id="last" class="status mono"></div>
      </div>

      <!-- Right: Helper / Summary -->
      <aside class="card rail">
        <header style="display:flex;align-items:center;gap:10px;margin:4px 0 10px">
          <span class="dot" aria-hidden="true"></span>
          <h2 style="margin:0;font-size:18px">Scurt ghid</h2>
        </header>
        <div class="summary">
          <div class="item"><b>Start</b> pornește pontajul</div>
          <div class="item"><b>Pause</b> / <b>Unpause</b> marchează pauzele.</div>
          <div class="item"><b>Finish</b> încheie ziua de lucru.</div>
          <div class="item"><b>Extra</b> marchează orele extra (separate de suplimentare).</div>
          <div class="item"><b>Concedii</b> — alege tipul și trimite cererea.</div>
        </div>
        <div class="footer">© <span id="year"></span> SERVELECT. Toate drepturile rezervate.</div>
      </aside>
    </section>
  </div>

  <!-- Hidden iframe for Google Forms -->
  <iframe name="hidden_iframe" style="display:none;"></iframe>

  <!-- Hidden iframe for Google Leave Form -->
  <iframe name="hidden_iframe_leave" style="display:none;"></iframe>
  <form id="leaveForm" method="POST" target="hidden_iframe_leave">
    <input type="hidden" id="lv_name" />
    <input type="hidden" id="lv_type" />
    <input type="hidden" id="lv_email" />
    <input type="hidden" id="lv_start" />
    <input type="hidden" id="lv_end" />
    <input type="hidden" id="lv_notes" />
    <input type="hidden" id="lv_ts" />
  </form>

  <!-- Google Forms payload form -->
  <form id="gform" method="POST" target="hidden_iframe">
    <input type="hidden" id="f_action" />
    <input type="hidden" id="f_timestamp" />
    <input type="hidden" id="f_name" />
    <input type="hidden" id="f_activity" />
    <input type="hidden" id="f_location" />
    <input type="hidden" id="f_lat" />
    <input type="hidden" id="f_lon" />
    <input type="hidden" id="f_acc" />
    <input type="hidden" id="f_device" />
    <input type="hidden" id="f_notes" />
    <input type="hidden" id="f_maps" />
    <!-- câmp dedicat pentru Extra (dacă ai un entry separat în Google Form, îl poți mapa din config.json) -->
    <input type="hidden" id="f_extra" />
  </form>

  <!-- Fallback inline employees list -->
  <script type="text/plain" id="employees-inline">
Ion Popescu
Maria Ionescu
Vlad Georgescu
Ana Radu
  </script>

  <script>document.getElementById('year').textContent = new Date().getFullYear();</script>

  <!-- Core app logic -->
  <script>
/** Trimite cererea de concediu la Apps Script WebApp (fără preflight CORS) */
async function sendLeave(payload) {
  const r = await fetch(CFG.leaveEndpoint, {
    method: 'POST',
    headers: {'Content-Type':'text/plain;charset=utf-8'},
    body: JSON.stringify(payload)
  });
  const txt = await r.text();
  let data;
  try { data = JSON.parse(txt); }
  catch { throw new Error('Răspuns invalid: ' + txt.slice(0,200)); }
  if (!r.ok || !data.ok) throw new Error((data && data.error) || ('HTTP '+r.status));
  return data;
}


(async function() {
  const statusEl = document.getElementById('status');
  const lastEl = document.getElementById('last');
  const empSel = document.getElementById('employeeSelect');
  const actSel = document.getElementById('activitySelect');
  const locInput = document.getElementById('locationInput');
  const notesEl = document.getElementById('notes');
  const btns = {
    start: document.getElementById('btnStart'),
    pause: document.getElementById('btnPause'),
    unpause: document.getElementById('btnUnpause'),
    finish: document.getElementById('btnFinish'),
    extra: document.getElementById('btnExtra')
  };

  let CFG = null;
  let lastActions = {}; // { "Ion Popescu": "finish", ... }

  function setStatus(msg, cls) {
    statusEl.className = 'status ' + (cls || '');
    statusEl.textContent = msg;
  }

  // ================== CONFIG ==================
  try {
    const r = await fetch('config.json?v=' + Date.now(), { cache: 'no-store' });
    if (!r.ok) throw new Error('Config lipsă');
    CFG = await r.json();
  } catch (e) {
    setStatus('Eroare config: ' + e.message, 'err');
    Object.values(btns).forEach(b => b.disabled = true);
    return;
  }

  // ================== LISTA ANGAJAȚI ==================
  async function loadEmployees() {
    try {
      if (CFG.employeesCsv) {
        const url = CFG.employeesCsv + '?v=' + Date.now();
        const r = await fetch(url);
        if (r.ok) {
          const text = await r.text();
          const list = text.split(/\r?\n/).map(s => s.trim()).filter(Boolean);
          fillEmployees(list);
          return;
        }
      }
    } catch (e) {}
    const inline = document.getElementById('employees-inline').textContent
      .split(/\r?\n/).map(s => s.trim()).filter(Boolean);
    fillEmployees(inline);
  }

  function fillEmployees(list) {
    empSel.innerHTML = '<option disabled selected>Alege angajat…</option>';
    list.forEach(v => {
      const o = document.createElement('option');
      o.value = o.textContent = v;
      empSel.appendChild(o);
    });
  }

  await loadEmployees();

  // ================== ULTIMA ACȚIUNE ==================
  async function fetchLastActions() {
    try {
      if (!CFG.lastActionEndpoint) return;
      const r = await fetch(CFG.lastActionEndpoint + '?t=' + Date.now());
      const data = await r.json();
      if (data && typeof data === 'object') lastActions = data;
    } catch (e) {
      console.warn('Nu pot prelua ultimele acțiuni:', e);
    }
  }

  await fetchLastActions();

  function getLastAction(name) {
    return (lastActions && lastActions[name]) || null;
  }

  // ================== LOGICĂ BUTOANE ==================
  function updateButtons() {
    const name = empSel.value;
    if (!name) return Object.values(btns).forEach(b => b.disabled = true);
    const last = getLastAction(name);
    Object.values(btns).forEach(b => b.disabled = true);

    if (!last || last === 'finish' || last === 'extra_finish') {
      btns.start.disabled = false;
      btns.extra.disabled = false;
    } else if (last === 'start' || last === 'unpause') {
      btns.pause.disabled = false;
      btns.finish.disabled = false;
    } else if (last === 'pause') {
      btns.unpause.disabled = false;
    } else if (last === 'extra_start') {
      btns.extra.textContent = 'Extra Finish';
      btns.extra.disabled = false;
    }
  }

  empSel.addEventListener('change', updateButtons);

  // ================== TRIMITERE ==================
  let busy = false;
  async function submitAction(action) {
    if (busy) return;
    const name = empSel.value;
    if (!name) return setStatus('Selectează angajat.', 'err');
    const last = getLastAction(name);

    // Validare logică
    const validPairs = {
      start: ['finish', 'pause', 'unpause'],
      pause: ['unpause'],
      unpause: ['pause', 'finish'],
      finish: ['start', 'unpause', 'pause'],
      extra_start: ['finish', 'extra_finish'],
      extra_finish: ['extra_start']
    };

    const ok = !last || validPairs[action]?.includes(last) || (action === 'start' && (!last || last === 'finish' || last === 'extra_finish'));
    if (!ok) {
      setStatus('Ordine invalidă: nu poți face "' + action + '" după "' + last + '".', 'warn');
      return;
    }

    busy = true;
    setStatus('Se trimite ' + action + '…', '');

    // Trimite către Google Form
    document.getElementById('f_action').value = action;
    document.getElementById('f_timestamp').value = new Date().toISOString();
    document.getElementById('f_name').value = name;
    document.getElementById('f_activity').value = actSel.value;
    document.getElementById('f_location').value = locInput.value.trim();
    document.getElementById('f_notes').value = notesEl.value;

    document.getElementById('gform').action = CFG.formAction;
    document.getElementById('gform').submit();

    setStatus('Trimis ✓ (' + action + ')', 'ok');
    lastActions[name] = action;
    updateButtons();

    setTimeout(() => { busy = false; }, 1000);
  }

  btns.start.addEventListener('click', () => submitAction('start'));
  btns.pause.addEventListener('click', () => submitAction('pause'));
  btns.unpause.addEventListener('click', () => submitAction('unpause'));
  btns.finish.addEventListener('click', () => submitAction('finish'));
  btns.extra.addEventListener('click', () => {
    const name = empSel.value;
    const last = getLastAction(name);
    const next = (last === 'extra_start')

</body>
</html>

Si  sa nu poti da pe extra start sau extra finish pana nu ai dat finish normal, si nici sa fai pe extra finish sau finish sau unpause fara butoanele lor aferente. Deci sa comunice cu google sheets, daca cineva are start sa poata da doar finish si doar o data  dupa ce a dat start. La fel si pause unpause
Vezi ca lostaangajatiilor sa ar incarce
